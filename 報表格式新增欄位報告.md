# 报表格式新增栏位报告

## 修改日期
2024-12-22

## 修改内容

### 1. 新增的栏位
根据用户需求，在代理层级分析报表中新增了以下栏位：

1. **级别** - 显示用户的级别（代理级别或会员）
   - 位置：第一栏
   - 格式：使用 badge 标签，代理为蓝色（bg-primary），会员为绿色（bg-success）

2. **余额** - 显示用户的当前余额
   - 位置：用户名之后
   - 格式：金额格式，靠右对齐

3. **笔数** - 显示下注笔数
   - 位置：余额之后，下注金额之前
   - 格式：数字格式，置中对齐

### 2. 表格结构调整
- 原本的栏位顺序：用户名 → 下注金额 → 有效金额...
- 新的栏位顺序：级别 → 用户名 → 余额 → 笔数 → 下注金额 → 有效金额...

### 3. 总计行调整
- 级别和用户名栏位合并显示「总计」（colspan="2"）
- 余额栏位显示 "-"（因为是多个用户的总计）
- 笔数栏位显示总笔数（从 totalSummary.betCount 取得）

### 4. colspan 调整
- 由于新增了 3 个栏位，所有 colspan 从 14 调整为 17

## 修改档案
1. `/agent/frontend/index.html`
2. `/deploy/frontend/index.html`

## 技术细节

### Vue 模板绑定
```html
<!-- 级别栏位 -->
<span class="badge" :class="item.userType === 'agent' ? 'bg-primary' : 'bg-success'">
    {{ item.level || '会员' }}
</span>

<!-- 余额栏位 -->
{{ formatMoney(item.balance || 0) }}

<!-- 笔数栏位 -->
{{ item.betCount || 0 }}
```

### 总计行处理
```html
<td class="text-center" colspan="2">总计</td>
<td class="text-center">-</td>
<td class="text-center">{{ reportData.totalSummary.betCount || 0 }}</td>
```

## 后端配合
后端 API 需要在返回的 reportData 中包含以下栏位：
- `level`：用户级别（如 "十级代理"、"九级代理" 等）
- `balance`：用户余额
- `betCount`：下注笔数

总计数据中需要包含：
- `totalSummary.betCount`：总下注笔数

## 测试建议
1. 确认新栏位正确显示各级代理和会员的数据
2. 确认余额格式化正确（使用 formatMoney 函数）
3. 确认笔数统计正确
4. 确认总计行正确计算和显示
5. 确认表格在不同萤幕尺寸下的响应式显示 